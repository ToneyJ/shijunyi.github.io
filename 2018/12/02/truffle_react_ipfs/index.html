<!DOCTYPE html>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="utf-8">
  
  <title>truffle_web3_ipfs | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="Truffle Introduction  一、安装truffle12cnpm install -g truffletruffle version 二、创建项目123mkdir truffleProjectcd truffleProjecttruffle init 三、添加合约代码1在contracts文件夹下，创建合约文件，添加代码 四、编译部署在巧克力合约1234truffle compile">
<meta property="og:type" content="article">
<meta property="og:title" content="truffle_web3_ipfs">
<meta property="og:url" content="http://yoursite.com/2018/12/02/truffle_react_ipfs/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="Truffle Introduction  一、安装truffle12cnpm install -g truffletruffle version 二、创建项目123mkdir truffleProjectcd truffleProjecttruffle init 三、添加合约代码1在contracts文件夹下，创建合约文件，添加代码 四、编译部署在巧克力合约1234truffle compile">
<meta property="og:locale" content="default">
<meta property="og:image" content="http://yoursite.com/2018/12/Library/Application%20Support/typora-user-images/image-20181128211605417.png">
<meta property="og:image" content="http://yoursite.com/2018/12/Library/Application%20Support/typora-user-images/image-20181129094808026.png">
<meta property="og:image" content="http://yoursite.com/2018/12/Library/Application%20Support/typora-user-images/image-20181129101226738.png">
<meta property="og:image" content="http://yoursite.com/2018/12/Library/Application%20Support/typora-user-images/image-20181129101252417.png">
<meta property="og:updated_time" content="2018-12-02T06:22:11.139Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="truffle_web3_ipfs">
<meta name="twitter:description" content="Truffle Introduction  一、安装truffle12cnpm install -g truffletruffle version 二、创建项目123mkdir truffleProjectcd truffleProjecttruffle init 三、添加合约代码1在contracts文件夹下，创建合约文件，添加代码 四、编译部署在巧克力合约1234truffle compile">
<meta name="twitter:image" content="http://yoursite.com/2018/12/Library/Application%20Support/typora-user-images/image-20181128211605417.png">
  
  
    <link rel="icon" href="/favicon.png">
  
  <!-- <link href='http://fonts.googleapis.com/css?family=Open+Sans:400,600' rel='stylesheet' type='text/css'> -->
  <!-- <link href="//fonts.googleapis.com/css?family=Source+Code+Pro:400,700" rel="stylesheet" type="text/css"> -->
  <link href="//fonts.useso.com/css?family=Source+Code+Pro:400,700" rel="stylesheet" type="text/css">
  <link href="//fonts.useso.com/css?family=Open+Sans:300,600" rel="stylesheet" type="text/css">
  <link rel="stylesheet" href="/shijunyi.github.io/css/style.css">
  

</head></html>
<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="header-outer" class="outer">
    <a href="/shijunyi.github.io/" class="logo">Hexo</a>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/shijunyi.github.io/">Home</a>
        
          <a class="main-nav-link" href="/shijunyi.github.io/archives">Archives</a>
        
          <a class="main-nav-link" href="/shijunyi.github.io/about/index.html">About</a>
        
      </nav>
      <nav id="sub-nav">
        <div id="search-form-wrap">
          <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
        </div>
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
        
        
          <a id="nav-github-link" class="nav-icon" href="https://github.com/ppoffice/hexo-theme-alex" title="Fork me on GitHub"></a>
        
      </nav>
    </div>
  </div>
</header>
      <nav id="mobile-nav" class="off">
  
    <a href="/shijunyi.github.io/" class="mobile-nav-link">Home</a>
  
    <a href="/shijunyi.github.io/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/shijunyi.github.io/about/index.html" class="mobile-nav-link">About</a>
  
  <div id="search-form-wrap-mobile">
    <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
  </div>
</nav>
      <div class="outer">
        
          <aside id="sidebar">
  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/shijunyi.github.io/archives/2018/12/">December 2018</a><span class="archive-list-count">2</span></li><li class="archive-list-item"><a class="archive-list-link" href="/shijunyi.github.io/archives/2018/11/">November 2018</a><span class="archive-list-count">1</span></li></ul>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recents</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/shijunyi.github.io/2018/12/02/truffle_react_ipfs/">truffle_web3_ipfs</a>
          </li>
        
          <li>
            <a href="/shijunyi.github.io/2018/12/01/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/shijunyi.github.io/2018/11/28/golang面试题/">golang笔试题</a>
          </li>
        
      </ul>
    </div>
  </div>

  
    
  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">links</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="http://hexo.io">Hexo</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
        <section id="main"><article id="post-truffle_react_ipfs" class="article article-type-post" itemscope="" itemprop="blogPost">
  <div class="article-meta">
    <a href="/shijunyi.github.io/2018/12/02/truffle_react_ipfs/" class="article-date">
  <time datetime="2018-12-02T06:20:48.792Z" itemprop="datePublished">2018-12-02</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      truffle_web3_ipfs
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="Truffle"><a href="#Truffle" class="headerlink" title="Truffle"></a>Truffle</h1><ul>
<li><a href="README.md">Introduction</a></li>
</ul>
<h2 id="一、安装truffle"><a href="#一、安装truffle" class="headerlink" title="一、安装truffle"></a>一、安装truffle</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cnpm install -g truffle</span><br><span class="line">truffle version</span><br></pre></td></tr></table></figure>
<h2 id="二、创建项目"><a href="#二、创建项目" class="headerlink" title="二、创建项目"></a>二、创建项目</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mkdir truffleProject</span><br><span class="line">cd truffleProject</span><br><span class="line">truffle init</span><br></pre></td></tr></table></figure>
<h2 id="三、添加合约代码"><a href="#三、添加合约代码" class="headerlink" title="三、添加合约代码"></a>三、添加合约代码</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">在contracts文件夹下，创建合约文件，添加代码</span><br></pre></td></tr></table></figure>
<h2 id="四、编译部署在巧克力合约"><a href="#四、编译部署在巧克力合约" class="headerlink" title="四、编译部署在巧克力合约"></a>四、编译部署在巧克力合约</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">truffle compile</span><br><span class="line">修改truffle-config.js配置文件</span><br><span class="line">truffle migrate --network ganacheNet</span><br><span class="line">truffle migrate</span><br></pre></td></tr></table></figure>
<h2 id="五、开发模式"><a href="#五、开发模式" class="headerlink" title="五、开发模式"></a>五、开发模式</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">truffle develop</span><br><span class="line">compile</span><br><span class="line">migrate</span><br></pre></td></tr></table></figure>
<h2 id="六、truffle-test"><a href="#六、truffle-test" class="headerlink" title="六、truffle test"></a>六、truffle test</h2><p>合约和函数必须以Test开头</p>
<p>例</p>
<figure class="highlight go"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> <span class="string">"truffle/Assert.sol"</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">"truffle/DeployedAddresses.sol"</span>;</span><br><span class="line"><span class="keyword">import</span> <span class="string">"../contracts/SimpleStorage.sol"</span>;</span><br><span class="line">contract TestSimpleStorage &#123;</span><br><span class="line">    function testSet() public &#123;</span><br><span class="line">        SimpleStorage simpleStorage = SimpleStorage(DeployedAddresses.SimpleStorage());</span><br><span class="line">		 simpleStorage.set(<span class="number">100</span>);</span><br><span class="line">        <span class="keyword">uint</span> expected = <span class="number">100</span>;</span><br><span class="line">        Assert.equal(simpleStorage.get(), expected, <span class="string">'should be 100'</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">truffle test</span><br></pre></td></tr></table></figure>
<h1 id="Truffle-React"><a href="#Truffle-React" class="headerlink" title="Truffle_React"></a>Truffle_React</h1><p>##一、集成react</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">truffle unbox react</span><br><span class="line">truffle develop</span><br><span class="line">compile</span><br><span class="line">migrate</span><br><span class="line">换一个终端</span><br><span class="line">npm run start</span><br></pre></td></tr></table></figure>
<h2 id="二、refs"><a href="#二、refs" class="headerlink" title="二、refs"></a>二、refs</h2><p><img src="../../Library/Application Support/typora-user-images/image-20181128211605417.png" alt="image-20181128211605417"></p>
<h1 id="web3-js"><a href="#web3-js" class="headerlink" title="web3.js"></a>web3.js</h1><h2 id="二、定义"><a href="#二、定义" class="headerlink" title="二、定义"></a>二、定义</h2><p>教程：<a href="https://github.com/ethereum/wiki/wiki/JavaScript-API#web3ethaccounts" target="_blank" rel="noopener">官方文档</a></p>
<p>web3.js是开发以太坊去中⼼心化应⽤用(DApp)必备的JavaScript库，提供了了⽤用于与geth通讯的<br>JavaScript API，web3.js使⽤用了了JSON-RPC协议与geth进⾏行行通信。<br>JSON-RPC是⼀一个⽆无状态，轻量量级的远程调⽤用协议(RPC)，允许使⽤用http，socket等协议进⾏行行<br>通讯，使⽤用JSON作为数据格式。<br>Web3.js可以与所有⽀支持JSON-RPC的节点进⾏行行通信，包括以太坊⽣生态中的其他节点，如<br>Whisper(⼀一个集成以太坊的⾮非实时性消息系统)和Swarm(⼀一个去中⼼心化的存储系统)<br>Web3.js⽆无法直接连接到以太坊⽹网络， 只能连接到以太坊节点，如:geth</p>
<h2 id="三、安装web3"><a href="#三、安装web3" class="headerlink" title="三、安装web3"></a>三、安装web3</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm install web3 --save</span><br></pre></td></tr></table></figure>
<h3 id="版本问题"><a href="#版本问题" class="headerlink" title="版本问题"></a>版本问题</h3><p>旧版本（0.xx）</p>
<p>1.官方文档：<a href="https://github.com/ethereum/wiki/wiki/JavaScript-API#web3ethaccounts" target="_blank" rel="noopener">https://github.com/ethereum/wiki/wiki/JavaScript-API#web3ethaccounts</a></p>
<p>2.特点：支持同步调用，只能通过回调函数调用</p>
<p>新版本</p>
<p>1.官方文档：<a href="https://web3js.readthedocs.io/en/1.0/web3-eth-accounts.html#eth-accounts" target="_blank" rel="noopener">https://web3js.readthedocs.io/en/1.0/web3-eth-accounts.html#eth-accounts</a></p>
<p>2.特点：不支持同步调用，支持回调方式，返回值都是promise</p>
<h2 id="四、web3包含的模块"><a href="#四、web3包含的模块" class="headerlink" title="四、web3包含的模块"></a>四、web3包含的模块</h2><p><img src="../../Library/Application Support/typora-user-images/image-20181129094808026.png" alt="image-20181129094808026"></p>
<h2 id="五、基础API"><a href="#五、基础API" class="headerlink" title="五、基础API"></a>五、基础API</h2><h3 id="1-BigNumber"><a href="#1-BigNumber" class="headerlink" title="1.BigNumber"></a>1.BigNumber</h3><h4 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cnpm i --save bignumber.js</span><br></pre></td></tr></table></figure>
<h4 id="使用方式"><a href="#使用方式" class="headerlink" title="使用方式"></a>使用方式</h4><h5 id="第一种"><a href="#第一种" class="headerlink" title="第一种"></a>第一种</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> BigNumber = <span class="built_in">require</span>(<span class="string">'bignumber.js'</span>)</span><br><span class="line"><span class="keyword">let</span> v = <span class="keyword">new</span> BigNumber(<span class="string">'123213213213213213213213213'</span>)</span><br></pre></td></tr></table></figure>
<h5 id="第二种"><a href="#第二种" class="headerlink" title="第二种"></a>第二种</h5><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> Web3 = <span class="built_in">require</span>(<span class="string">'web3'</span>)</span><br><span class="line"><span class="keyword">let</span> web3 = <span class="keyword">new</span> Web3()</span><br><span class="line"><span class="keyword">let</span> v = web3.utils.toBN(v)</span><br></pre></td></tr></table></figure>
<h4 id="算数运算"><a href="#算数运算" class="headerlink" title="算数运算"></a>算数运算</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">'====加法===='</span>)</span><br><span class="line">m = <span class="keyword">new</span> BigNumber(<span class="number">10101</span>, <span class="number">2</span>);</span><br><span class="line">n = <span class="keyword">new</span> BigNumber(<span class="string">"ABCD"</span>, <span class="number">16</span>); <span class="built_in">console</span>.log(m.plus(n)) <span class="built_in">console</span>.log(m.plus(n).toString())</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'====减法===='</span>)</span><br><span class="line">x = <span class="keyword">new</span> BigNumber(<span class="number">0.5</span>)</span><br><span class="line">y = <span class="keyword">new</span> BigNumber(<span class="number">0.4</span>) <span class="built_in">console</span>.log(<span class="number">0.5</span> - <span class="number">0.4</span>) <span class="built_in">console</span>.log(x.minus(y).toString())</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'====乘法===='</span>)</span><br><span class="line">x = <span class="keyword">new</span> BigNumber(<span class="string">'2222222222222222222222222222222222'</span>)</span><br><span class="line">y = <span class="keyword">new</span> BigNumber(<span class="string">'7777777777777777777777777777777777'</span>, <span class="number">16</span>) <span class="built_in">console</span>.log(x.times(y).toString())</span><br><span class="line"></span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'====除法===='</span>) <span class="built_in">console</span>.log(x.div(y).toString()) <span class="built_in">console</span>.log(x.div(y).toFixed(<span class="number">6</span>).toString())</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">'==== x = -123.456===='</span>)</span><br><span class="line">x = <span class="keyword">new</span> BigNumber(<span class="number">-123.456</span>)</span><br><span class="line"><span class="built_in">console</span>.log(x)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"尾数x.c:"</span>,x.c) <span class="built_in">console</span>.log(<span class="string">"指数x.e:"</span>,x.e) <span class="built_in">console</span>.log(<span class="string">"符号x.s:"</span>,x.s)</span><br></pre></td></tr></table></figure>
<h3 id="2-utils工具包"><a href="#2-utils工具包" class="headerlink" title="2.utils工具包"></a>2.utils工具包</h3><h4 id="单位转换"><a href="#单位转换" class="headerlink" title="单位转换"></a>单位转换</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">web3.utils.fromWei(<span class="string">'12345567890876433'</span>, <span class="string">'ether'</span>)</span><br><span class="line">web3.utils.fromWei(<span class="string">'12345567890876433'</span>, <span class="string">'Gwei'</span>)</span><br><span class="line">web3.utils.fromWei(<span class="string">'12345567890876433'</span>, <span class="string">'Mwei'</span>)</span><br><span class="line"></span><br><span class="line">web3.utils.toWei(<span class="string">'1'</span>, <span class="string">'ether'</span>)</span><br><span class="line">web3.utils.toWei(<span class="string">'1'</span>, <span class="string">'Gwei'</span>)</span><br><span class="line">web3.utils.toWei(<span class="string">'1'</span>, <span class="string">'Mwei'</span>)</span><br></pre></td></tr></table></figure>
<h4 id="进制转换"><a href="#进制转换" class="headerlink" title="进制转换"></a>进制转换</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">web3.utils.toHex(<span class="string">'a'</span>)</span><br><span class="line"><span class="built_in">JSON</span>.stringify(&#123;<span class="attr">name</span>:<span class="string">'Duke'</span>&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="ASCII与十六进制"><a href="#ASCII与十六进制" class="headerlink" title="ASCII与十六进制"></a>ASCII与十六进制</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">console</span>.log(<span class="string">"先将字符串串'xyz'转换为ascii，然后转化为⼗十六进制"</span>) <span class="keyword">var</span> str = web3.utils.fromAscii(<span class="string">'xyz'</span>)</span><br><span class="line"><span class="built_in">console</span>.log(str)</span><br><span class="line"><span class="built_in">console</span>.log(<span class="string">"先将⼗十六进制转换为ascii，然后转化为字符串串"</span>) str = web3.utils.toAscii(<span class="string">'0x78797a'</span>) <span class="built_in">console</span>.log(str)</span><br></pre></td></tr></table></figure>
<h4 id="hash"><a href="#hash" class="headerlink" title="hash"></a>hash</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">web3.utils.sha3(hash0)</span><br></pre></td></tr></table></figure>
<h4 id="其它"><a href="#其它" class="headerlink" title="其它"></a>其它</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">web3.utils.toDecimal()</span><br><span class="line">web3.utils.toBigNumber()</span><br><span class="line">web3.utils.isAddress(add1)</span><br></pre></td></tr></table></figure>
<h2 id="六、web3工作模式"><a href="#六、web3工作模式" class="headerlink" title="六、web3工作模式"></a>六、web3工作模式</h2><p><img src="../../Library/Application Support/typora-user-images/image-20181129101226738.png" alt="image-20181129101226738"></p>
<p><img src="../../Library/Application Support/typora-user-images/image-20181129101252417.png" alt="image-20181129101252417"></p>
<h2 id="七、其它相关函数"><a href="#七、其它相关函数" class="headerlink" title="七、其它相关函数"></a>七、其它相关函数</h2><h3 id="1-获取账户"><a href="#1-获取账户" class="headerlink" title="1.获取账户"></a>1.获取账户</h3><h4 id="第一种（回调函数）"><a href="#第一种（回调函数）" class="headerlink" title="第一种（回调函数）"></a>第一种（回调函数）</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">web3.eth.getAccounts(<span class="function">(<span class="params">err,res</span>)=&gt;</span>&#123;</span><br><span class="line">	accounts = res</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="第二种（then）"><a href="#第二种（then）" class="headerlink" title="第二种（then）"></a>第二种（then）</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">web3.eth.getAccounts().then(<span class="function"><span class="params">accounts</span>=&gt;</span>&#123;</span><br><span class="line">    <span class="built_in">console</span>.log(accounts)</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure>
<h4 id="第三种（promise）"><a href="#第三种（promise）" class="headerlink" title="第三种（promise）"></a>第三种（promise）</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">test() = <span class="keyword">async</span>()=&gt;&#123;</span><br><span class="line">    accounts = <span class="keyword">await</span> web3.eth.getAccounts()</span><br><span class="line">    <span class="built_in">console</span>.log(accounts)</span><br><span class="line">&#125;</span><br><span class="line">test()</span><br></pre></td></tr></table></figure>
<h3 id="2-基础API"><a href="#2-基础API" class="headerlink" title="2.基础API"></a>2.基础API</h3><table>
<thead>
<tr>
<th>api</th>
<th>含义</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>web3.utils.fromWei(1000, ‘ether’)</td>
<td>由1000wei转成ether</td>
<td></td>
</tr>
<tr>
<td>web3.utils.toWei(1, ‘ether’)</td>
<td>由1ether转成wei</td>
<td></td>
</tr>
<tr>
<td>bignumber</td>
<td>能够处理理⼤大的数据</td>
<td></td>
</tr>
<tr>
<td>web3.utils.toHex</td>
<td>转成16进制</td>
<td></td>
</tr>
<tr>
<td>web3.utils.fromAscii</td>
<td>由ascii转成16进制</td>
<td></td>
</tr>
<tr>
<td>web3.utils.isAddress</td>
<td>判断是否为地址</td>
<td></td>
</tr>
<tr>
<td>web3.utils.sha3</td>
<td>sha3哈希函数</td>
<td></td>
</tr>
<tr>
<td>web3.utils.toDecimal</td>
<td>转成10进制</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>api</th>
<th>含义</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>web3.eth.getAccounts()</td>
<td>获取当前的账户</td>
<td><code>⼀一般只返回当前助记词的主账户</code></td>
</tr>
<tr>
<td>web3.eth.getBalance()</td>
<td>获取指定地址的余额</td>
<td></td>
</tr>
<tr>
<td>web3.eth.defaultAccount()</td>
<td>默认区块</td>
<td></td>
</tr>
<tr>
<td>web3.eth.sendTransaction()</td>
<td>转账</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<table>
<thead>
<tr>
<th>api</th>
<th>含义</th>
<th>备注</th>
</tr>
</thead>
<tbody>
<tr>
<td>web3.eth.Contract( JSON.parse(interface)).deploy()</td>
<td>部署合约</td>
<td></td>
</tr>
<tr>
<td>web3.eth.⽅方法.send()</td>
<td>调⽤用函数向合约写数据</td>
<td></td>
</tr>
<tr>
<td>web3.eth.⽅方法.call()</td>
<td>调⽤用函数向合约读数据</td>
<td></td>
</tr>
<tr>
<td>Web3.providers.HttpProvider(“<a href="http://localhost:8545&quot;" target="_blank" rel="noopener">http://localhost:8545&quot;</a>)</td>
<td>创建provider</td>
<td></td>
</tr>
<tr>
<td>window.web3.currentProvider</td>
<td>获取当前的provider</td>
<td></td>
</tr>
<tr>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<h1 id="IPFS"><a href="#IPFS" class="headerlink" title="IPFS"></a>IPFS</h1><h2 id="一、定义"><a href="#一、定义" class="headerlink" title="一、定义"></a>一、定义</h2><p>IPFS是⼀一种点对点的超媒体⽂文件存储、索引、交换协议。</p>
<p>参考链接:<a href="http://www.ipfs.cn/news/info-100173.html" target="_blank" rel="noopener">http://www.ipfs.cn/news/info-100173.html</a></p>
<h3 id="二、安装IPFS"><a href="#二、安装IPFS" class="headerlink" title="二、安装IPFS"></a>二、安装IPFS</h3><h4 id="1-修改host文件"><a href="#1-修改host文件" class="headerlink" title="1.修改host文件"></a>1.修改host文件</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">217.182.195.23 ipfs.io</span><br></pre></td></tr></table></figure>
<h4 id="2-二进制安装"><a href="#2-二进制安装" class="headerlink" title="2.二进制安装"></a>2.二进制安装</h4><p><a href="https://ipfs.io/" target="_blank" rel="noopener">官网下载</a></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">tar xvfz go-ipfs.tar.gz</span><br><span class="line">cd go-ipfs</span><br><span class="line">./install.sh</span><br></pre></td></tr></table></figure>
<h4 id="3-源码安装"><a href="#3-源码安装" class="headerlink" title="3.源码安装"></a>3.源码安装</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/ipfs/go-ipfs.git</span><br><span class="line">make install</span><br></pre></td></tr></table></figure>
<h3 id="三、项目配置"><a href="#三、项目配置" class="headerlink" title="三、项目配置"></a>三、项目配置</h3><h4 id="1-创建本地项目节点"><a href="#1-创建本地项目节点" class="headerlink" title="1.创建本地项目节点"></a>1.创建本地项目节点</h4><p>ipfs init会在home目录下创建一个隐藏文件夹.ipfs</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ipfs init</span><br><span class="line">ls .ipfs/</span><br></pre></td></tr></table></figure>
<h4 id="2-修改默认存储空间"><a href="#2-修改默认存储空间" class="headerlink" title="2.修改默认存储空间"></a>2.修改默认存储空间</h4><p>打开配置文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">vi .ipfs/config//第一种</span><br><span class="line"></span><br><span class="line">//第二种</span><br><span class="line">export EDITOR=/usr/bin/vim</span><br><span class="line">ipfs config</span><br></pre></td></tr></table></figure>
<p>修改</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">&#125;,</span><br><span class="line">  "Datastore": &#123;</span><br><span class="line">"StorageMax": "20GB", //&lt;&lt;&lt;---------这⾥里里!!!!默认10G此处修改为20G，可 根据需要⾃自⾏行行调整</span><br><span class="line">    "StorageGCWatermark": 90,</span><br><span class="line">    "GCPeriod": "1h",</span><br><span class="line">    "Spec": &#123;</span><br><span class="line">"mounts": [ &#123;</span><br><span class="line">"child": &#123;</span><br><span class="line">     "path": "blocks",</span><br><span class="line">    "shardFunc": "/repo/flatfs/shard/v1/next-to-last/2",</span><br><span class="line">    "sync": true,</span><br><span class="line">    "type": "flatfs"</span><br><span class="line">  &#125;,</span><br><span class="line">  "mountpoint": "/blocks",</span><br><span class="line">  "prefix": "flatfs.datastore",</span><br><span class="line">  "type": "measure"</span><br><span class="line">&#125;, &#123;</span><br><span class="line">"child": &#123;</span><br><span class="line">  "compression": "none",</span><br><span class="line">  "path": "datastore",</span><br><span class="line">  "type": "levelds"</span><br><span class="line">&#125;,</span><br><span class="line">"mountpoint": "/",</span><br><span class="line">"prefix": "leveldb.datastore",</span><br><span class="line">"type": "measure"</span><br></pre></td></tr></table></figure>
<h3 id="四、启动服务"><a href="#四、启动服务" class="headerlink" title="四、启动服务"></a>四、启动服务</h3><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ipfs daemon</span><br></pre></td></tr></table></figure>
<h3 id="五、基本命令"><a href="#五、基本命令" class="headerlink" title="五、基本命令"></a>五、基本命令</h3><table>
<thead>
<tr>
<th style="text-align:center">基本命令</th>
<th style="text-align:center">解释</th>
</tr>
</thead>
<tbody>
<tr>
<td style="text-align:center">add</td>
<td style="text-align:center">添加文件</td>
</tr>
<tr>
<td style="text-align:center">cat</td>
<td style="text-align:center">查看文件</td>
</tr>
<tr>
<td style="text-align:center">get(-c -o)</td>
<td style="text-align:center">下载文件</td>
</tr>
<tr>
<td style="text-align:center">ls</td>
<td style="text-align:center">查看文件属性</td>
</tr>
<tr>
<td style="text-align:center">refs</td>
<td style="text-align:center">查看被引用哈希</td>
</tr>
<tr>
<td style="text-align:center">文件</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">ipfs files mkdir</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">ipfs files cp</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">ipfs files flush[]</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">pfs files ls []</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">ipfs files mv</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">ipfs files read</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">ipfs files rm</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">ipfs files stat</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">ipfs files write</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">后台</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">ipfs daemon</td>
<td style="text-align:center">连接公网</td>
</tr>
<tr>
<td style="text-align:center">ipfs daemon –offline</td>
<td style="text-align:center">连接到本地网络</td>
</tr>
<tr>
<td style="text-align:center">name解析</td>
<td style="text-align:center"></td>
</tr>
<tr>
<td style="text-align:center">ipfs name publish &lt;目录的哈希&gt;</td>
<td style="text-align:center">IPNS 注意使用ipns，而不是ipfs</td>
</tr>
</tbody>
</table>
<h3 id="六、设置跨域资源"><a href="#六、设置跨域资源" class="headerlink" title="六、设置跨域资源"></a>六、设置跨域资源</h3><p>为了⽅便后续开发，我们需要对ipfs的跨域资源共享(CORS)进行配置，(请执行ctrl+c退出刚刚启动的 daemon服务)，直接在命令行行行如下命令。 </p>
<p>使用ipfs-api的时候会⽤到这里 </p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">ipfsconfig--jsonAPI.HTTPHeaders.Access-Control-Allow-Methods '["PUT","GET", "POST", "OPTIONS"]'</span><br><span class="line">ipfsconfig--jsonAPI.HTTPHeaders.Access-Control-Allow-Origin'["*"]'</span><br><span class="line">ipfsconfig--jsonAPI.HTTPHeaders.Access-Control-Allow-Credentials '["true"]'</span><br><span class="line">ipfsconfig--jsonAPI.HTTPHeaders.Access-Control-Allow-Headers '["Authorization"]'</span><br><span class="line">ipfsconfig--jsonAPI.HTTPHeaders.Access-Control-Expose-Headers '["Location"]'</span><br></pre></td></tr></table></figure>
<p>###七、IPFS_API</p>
<h4 id="获取ipfs"><a href="#获取ipfs" class="headerlink" title="获取ipfs"></a>获取ipfs</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> ipfsAPI = <span class="built_in">require</span>(<span class="string">'ipfs-api'</span>)</span><br><span class="line"><span class="keyword">const</span> ipfs = ipfsAPI(<span class="string">'localhost'</span>,<span class="string">'5001'</span>,&#123;<span class="attr">protocol</span>:<span class="string">'http'</span>&#125;)</span><br></pre></td></tr></table></figure>
<h3 id="add-cat-ls"><a href="#add-cat-ls" class="headerlink" title="add,cat,ls"></a>add,cat,ls</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> test = <span class="keyword">async</span>()=&gt;&#123;</span><br><span class="line">    <span class="keyword">let</span> res = <span class="keyword">await</span> ipfs.files.add(Buffer.from(<span class="string">'helloworld'</span>))</span><br><span class="line">    </span><br><span class="line">    res = <span class="keyword">await</span> ipfs.files.cat(res[<span class="number">0</span>].hash)</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">let</span> files = <span class="keyword">await</span> ipfs.files.ls(<span class="string">'/box'</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/12/02/truffle_react_ipfs/" data-id="cjp6i0n5i0002rwyhz5vfo2jh" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
  
    <a href="/shijunyi.github.io/2018/12/01/hello-world/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Hello World</div>
    </a>
  
</nav>

  
</article>

</section>
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      <a href="/shijunyi.github.io/" class="logo">Hexo</a>
      &copy; 2018 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    

<script src="/shijunyi.github.io/js/jquery.min.js"></script>
<script src="/shijunyi.github.io/js/jquery.scrollLoading.js"></script>


  <link rel="stylesheet" href="/shijunyi.github.io/fancybox/jquery.fancybox.css">
  <script src="/shijunyi.github.io/fancybox/jquery.fancybox.pack.js"></script>


<script src="/shijunyi.github.io/js/script.js"></script>

  </div>
</body>
</html>